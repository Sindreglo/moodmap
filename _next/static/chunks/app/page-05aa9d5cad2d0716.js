(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3383:()=>{},6170:o=>{o.exports={overlay:"MoodModal_overlay__j9wmK",fadeIn:"MoodModal_fadeIn__rJAPy",modal:"MoodModal_modal__Ulwf6",slideUp:"MoodModal_slideUp__Glfbz",subtitle:"MoodModal_subtitle__pxkSb",closeButton:"MoodModal_closeButton__RayT0",moodGrid:"MoodModal_moodGrid__0bSmA",moodButton:"MoodModal_moodButton__5KOPJ",selected:"MoodModal_selected__aKRVo",emoji:"MoodModal_emoji__hBJQc",label:"MoodModal_label__SvIgh",number:"MoodModal_number__yYa6D",submitButton:"MoodModal_submitButton___hk3e"}},6489:o=>{o.exports={main:"page_main__ux7yf",header:"page_header__8kWA1",addMoodButton:"page_addMoodButton__Z3CJs"}},8343:o=>{o.exports={mapContainer:"Map_mapContainer__a24lE",marker:"Map_marker__cp_iY"}},8390:(o,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>b});var n=t(5155),r=t(2115);let a="/moodmap",l={1:"".concat(a,"/mood-icons/rating_1.png"),2:"".concat(a,"/mood-icons/rating_2.png"),3:"".concat(a,"/mood-icons/rating_3.png"),4:"".concat(a,"/mood-icons/rating_4.png"),5:"".concat(a,"/mood-icons/rating_5.png")};var s=t(7856),c=t.n(s);t(3383);var d=t(8343),i=t.n(d);function u(o){let{moods:e}=o,t=(0,r.useRef)(null),a=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(!a.current&&t.current)return a.current=new(c()).Map({container:t.current,style:"mapbox://styles/mapbox/standard",center:[0,20],zoom:2}),()=>{var o;null==(o=a.current)||o.remove()}},[]),(0,r.useEffect)(()=>{var o,t;if(!a.current)return;let n={type:"FeatureCollection",features:e.map(o=>({type:"Feature",properties:{mood:o.mood,timestamp:o.timestamp},geometry:{type:"Point",coordinates:[o.lng,o.lat]}}))},r=()=>{var o,e;(null==(o=a.current)?void 0:o.getSource("moods"))?a.current.getSource("moods").setData(n):(null==(e=a.current)||e.addSource("moods",{type:"geojson",data:n,cluster:!0,clusterMaxZoom:16,clusterRadius:80,clusterProperties:{sum:["+",["get","mood"]],count:["+",1]}}),(async()=>{for(let[o,e]of Object.entries(l)){let t="mood-icon-".concat(o);a.current&&!a.current.hasImage(t)&&await new Promise((o,n)=>{a.current.loadImage(e,(e,r)=>{if(e||!r)return n(e);a.current.hasImage(t)||a.current.addImage(t,r,{pixelRatio:2}),o()})})}})().then(()=>{var o,e,t,n;(null==(o=a.current)?void 0:o.getLayer("clusters"))||null==(t=a.current)||t.addLayer({id:"clusters",type:"symbol",source:"moods",filter:["has","point_count"],layout:{"icon-image":["concat","mood-icon-",["to-string",["max",1,["min",5,["round",["case",["==",["get","count"],0],3,["/",["get","sum"],["get","count"]]]]]]]],"icon-size":["interpolate",["linear"],["get","point_count"],1,.175,10,.225,25,.275,50,.31,100,.35],"icon-allow-overlap":!0}}),(null==(e=a.current)?void 0:e.getLayer("mood-points"))||null==(n=a.current)||n.addLayer({id:"mood-points",type:"symbol",source:"moods",filter:["!has","point_count"],layout:{"icon-image":["concat","mood-icon-",["to-string",["get","mood"]]],"icon-size":.175,"icon-allow-overlap":!0}})}))};(null==(o=a.current)?void 0:o.isStyleLoaded())?r():null==(t=a.current)||t.once("style.load",r);let s=o=>{let e=o.features&&o.features[0];if(!e)return;let{mood:t,timestamp:n}=e.properties;new(c()).Popup().setLngLat(e.geometry.coordinates).setHTML('<div style="padding: 5px;">\n            <strong>Mood: '.concat(t,"/5</strong><br/>\n            <small>").concat(new Date(Number(n)).toLocaleString(),"</small>\n          </div>")).addTo(a.current)};a.current.on("click","mood-points",s);let d=o=>{var e,t,n;let r=null==(e=a.current)?void 0:e.queryRenderedFeatures(o.point,{layers:["clusters"]});if(!r||!r.length)return;let l=null==(t=r[0].properties)?void 0:t.cluster_id;(null==(n=a.current)?void 0:n.getSource("moods")).getClusterExpansionZoom(l,(o,e)=>{if(!o&&"number"==typeof e){var t;null==(t=a.current)||t.easeTo({center:r[0].geometry.coordinates,zoom:e})}})};return a.current.on("click","clusters",d),()=>{a.current&&(a.current.off("click","mood-points",s),a.current.off("click","clusters",d))}},[e]),(0,n.jsx)("div",{ref:t,className:i().mapContainer})}c().accessToken="pk.eyJ1Ijoic2luZHJlZ2xvIiwiYSI6ImNtZ2hwYjBtMTAwbHgybHBocXVhOWMwcGoifQ.DUfBhUikbPUCTJVERbXDMg";var m=t(6170),p=t.n(m);let _=["\uD83D\uDE22","\uD83D\uDE15","\uD83D\uDE10","\uD83D\uDE42","\uD83D\uDE04"],g=["Very Bad","Bad","Neutral","Good","Very Good"];function h(o){let{onClose:e,onSubmit:t}=o,[a,l]=(0,r.useState)(null);return(0,n.jsx)("div",{className:p().overlay,onClick:e,children:(0,n.jsxs)("div",{className:p().modal,onClick:o=>o.stopPropagation(),children:[(0,n.jsx)("button",{className:p().closeButton,onClick:e,children:"\xd7"}),(0,n.jsx)("h2",{children:"How are you feeling?"}),(0,n.jsx)("p",{className:p().subtitle,children:"Select your current mood"}),(0,n.jsx)("div",{className:p().moodGrid,children:[1,2,3,4,5].map(o=>(0,n.jsxs)("button",{className:"".concat(p().moodButton," ").concat(a===o?p().selected:""),onClick:()=>l(o),children:[(0,n.jsx)("span",{className:p().emoji,children:_[o-1]}),(0,n.jsx)("span",{className:p().label,children:g[o-1]}),(0,n.jsx)("span",{className:p().number,children:o})]},o))}),(0,n.jsx)("button",{className:p().submitButton,onClick:()=>{null!==a&&(navigator.geolocation?navigator.geolocation.getCurrentPosition(o=>{t(a,o.coords.latitude,o.coords.longitude)},()=>{alert("Could not get your location. Please enable location services and try again.")}):alert("Geolocation is not supported by your browser."))},disabled:null===a,children:"Submit Mood"})]})})}var M=t(6489),f=t.n(M);function y(o,e){return Math.random()*(e-o)+o}function b(){let[o,e]=(0,r.useState)(function(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,e=[];for(let t=0;t<o;t++){let o=Math.floor(y(1,6)),n=y(35,70),r=y(-10,40);e.push({id:"random-".concat(t,"-").concat(Date.now()),mood:o,lat:n,lng:r,timestamp:Date.now()-Math.floor(y(0,1e8))})}return e}(5e3)),[t,a]=(0,r.useState)(!1);return(0,n.jsxs)("main",{className:f().main,children:[(0,n.jsxs)("div",{className:f().header,children:[(0,n.jsx)("h1",{children:"MoodMap"}),(0,n.jsx)("p",{children:"Share your mood with the world"})]}),(0,n.jsx)("button",{className:f().addMoodButton,onClick:()=>a(!0),children:"+ Add Your Mood"}),(0,n.jsx)(u,{moods:o}),t&&(0,n.jsx)(h,{onClose:()=>a(!1),onSubmit:(t,n,r)=>{e([...o,{id:Date.now().toString(),mood:t,lat:n,lng:r,timestamp:Date.now()}]),a(!1)}})]})}},9791:(o,e,t)=>{Promise.resolve().then(t.bind(t,8390))}},o=>{o.O(0,[409,240,441,255,358],()=>o(o.s=9791)),_N_E=o.O()}]);